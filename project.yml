name: LongWeekend
options:
  bundleIdPrefix: com.funzin
  minimumXcodeGenVersion: 2.23.1
  postGenCommand: make install-pod
  deploymentTarget:
    iOS: 13.0
targets:
  LongWeekend:
    type: application
    platform: iOS
    sources: [LongWeekend]
    settings:
      base:
        INFOPLIST_FILE: LongWeekend/Resource/Info.plist
        CODE_SIGN_STYLE: Manual
    prebuildScripts:
      - name: Run SwiftGen
        script: make swiftgen
      - name: Run SwiftLint
        script: make swiftlint
      - name: Run LicensPlist
        script: |
                if [ $CONFIGURATION = "Debug" ]; then
                  make license-plist
                fi
      - name: Configure Admob
        script: |
                plistBuddy="/usr/libexec/PlistBuddy"
                Resource="${SRCROOT}/LongWeekend/Resource/"
                infoPlistFileDestination="${TEMP_DIR}/Preprocessed-Info.plist"
                
                envPath="${SRCROOT}/.env"
                if [ -e $envPath ]; then
                  . $envPath
                  $plistBuddy -c "Set :GADApplicationIdentifier ${GAD_APPLICATION_ID}" ${infoPlistFileDestination}
                fi
    scheme:
      gatherCoverageData: true
      testTargets:
        - LongWeekendTests
  LongWeekendTests:
    type: bundle.unit-test
    platform: iOS
    sources: [LongWeekendTests]
    dependencies:
      - target: LongWeekend
